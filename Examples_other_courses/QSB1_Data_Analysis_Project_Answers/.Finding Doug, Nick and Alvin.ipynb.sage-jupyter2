{"args":["--to","html","--template","classic"],"start":1635856110284,"state":"done","time":1635856116313,"type":"nbconvert"}
{"backend_state":"init","connection_file":"/tmp/xdg-runtime-user/jupyter/kernel-bfa26a01-138e-4dfb-9771-1b7bbbb15fe2.json","kernel":"python3","kernel_error":"","kernel_state":"idle","kernel_usage":{"cpu":0,"memory":0},"metadata":{"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.8.5"}},"trust":true,"type":"settings"}
{"cell_type":"code","exec_count":1,"id":"c1a696","input":"def start_present(dna_seq):\n    ### BEGIN SOLUTION\n    '''Returns True if dna_seq startwith ATG, else returns False'''\n    if dna_seq.startswith('ATG'):\n        return True\n    else:\n        return False\n    ### END SOLUTION","metadata":{"nbgrader":{"grade":false,"grade_id":"task1","locked":false,"schema_version":3,"solution":true,"task":false}},"pos":4,"type":"cell"}
{"cell_type":"code","exec_count":1,"id":"f8ad84","input":"import pandas as pd\nfrom pandas.api.types import CategoricalDtype\n\n# Read in SARS-CoV-2 Spike Protein Sequences into a pandas dataframe\nspike_df = pd.read_csv('spike_proteins.csv')\n\n# Set the type of the variable month_name as categorical ordinal so that plots and tables are ordered chronologically\ncat_type = CategoricalDtype(categories=['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'], ordered=True)\nspike_df['month_name'] = spike_df['month_name'].astype(cat_type)\n\n# Output the first 10 rows\nprint(spike_df.head(10))\n\n# Output the number of rows and columns\nspike_df.shape","metadata":{"nbgrader":{"grade":false,"grade_id":"read_csv","locked":true,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"             sequence_name  country sample_date  epi_week position_614  \\\n0  England/PHEC-10E9A/2020  England  2020-01-29         5            D   \n1  England/PHEC-10EC7/2020  England  2020-02-08         6            D   \n2  England/PHEC-10EB8/2020  England  2020-02-08         6            D   \n3  England/PHEC-10F1F/2020  England  2020-02-09         7            D   \n4  England/PHEC-1AFD9/2020  England  2020-02-09         7            D   \n5  England/PHEC-1AFE8/2020  England  2020-02-13         7            D   \n6  England/PHEC-1B002/2020  England  2020-02-14         7            D   \n7  England/PHEC-1B06C/2020  England  2020-02-16         8            D   \n8  England/PHEC-20FFE/2020  England  2020-02-16         8            G   \n9  England/PHEC-1B04E/2020  England  2020-02-16         8            D   \n\n  position_439 position_222  S_mutations month_name  month  \n0            N            A            0    January      1  \n1            N            A            0   February      2  \n2            N            A            0   February      2  \n3            N            A            0   February      2  \n4            N            A            0   February      2  \n5            N            A            0   February      2  \n6            N            A            0   February      2  \n7            N            A            0   February      2  \n8            N            A            2   February      2  \n9            N            A            1   February      2  \n"},"1":{"data":{"text/plain":"(67243, 10)"},"exec_count":1,"output_type":"execute_result"}},"pos":10,"type":"cell"}
{"cell_type":"code","exec_count":10,"id":"c4139c","input":"# Check that filter_seq() excludes sequences containing ambiguous (N) nucleotides.\n# This cell will execute without error if filter_seq() is correctly excluding sequences containing N nucleotides.\n\nfrom nose.tools import assert_equal\ntest_seqs_N=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ATAATGGTTGTTGCCAGCCGGTGTGGAAGGTAACAGCACCGGTGCGAGCCTAATGTGCCGTCTCCACCAACA', 'TAGTATACGTCTAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGACATTGTCCCTGATTTCTCCA', 'TGCACTACCGTCANNTACGCTAGTATGCGTTCTTCCTTCCAGAGGTATGTGGCTGCGTGGTCAAAAGTGCGG', 'CATTCGTATTTGCTCCTCGTGTTTACTCTCACAAACTTGACCTGGAGNANAAGGAGATGCTTCTTGTGGAAC']\ncorrect_seqs=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ATAATGGTTGTTGCCAGCCGGTGTGGAAGGTAACAGCACCGGTGCGAGCCTAATGTGCCGTCTCCACCAACA', 'TAGTATACGTCTAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGACATTGTCCCTGATTTCTCCA']\n\nassert_equal(filter_seq(test_seqs_N), correct_seqs)\nprint('Test 1 of 4 passed: filter_seq excluded sequences with N nucleotides.')","metadata":{"nbgrader":{"grade":true,"grade_id":"task2_autograder1_Nfilter","locked":true,"points":3,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 1 of 4 passed: filter_seq excluded sequences with N nucleotides.\n"}},"pos":29,"type":"cell"}
{"cell_type":"code","exec_count":11,"id":"aae5e0","input":"# Check that filter_seq() removes sequences that are not 72 nucleotides long.\n# This cell will execute without error if filter_seq() excludes sequences that are not exactly 72 nucleotides in length.\n\nfrom nose.tools import assert_equal\ntest_seqs_length=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ATAATGGTTGTTGCCAGCCGGTGTGGAAGGTAACAGCACCGGTGCGAGCCTAATGTGCCGTCTCCACCAACA', 'TAGTATACGTCTAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGACATTGTCCCTGATTTCTCCA', 'CTACTAATAGCACACACGGGGCAATACCAGCACAAGCTAGTCTCGCGGGAACGCTCGTCAGCATACGAAAGAGC', 'CTTGGGTGTTT']\ncorrect_seqs=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ATAATGGTTGTTGCCAGCCGGTGTGGAAGGTAACAGCACCGGTGCGAGCCTAATGTGCCGTCTCCACCAACA', 'TAGTATACGTCTAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGACATTGTCCCTGATTTCTCCA']\nassert_equal(filter_seq(test_seqs_length), correct_seqs)\nprint('Test 2 of 4 passed: filter_seq excluded sequences not of 72 nucleotides in length')","metadata":{"nbgrader":{"grade":true,"grade_id":"task2_autograder2_length","locked":true,"points":2,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 2 of 4 passed: filter_seq excluded sequences not of 72 nucleotides in length\n"}},"pos":30,"type":"cell"}
{"cell_type":"code","exec_count":12,"id":"a5baed","input":"# Check that filter_seq() converts all sequences to UPPERCASE\n# This cell will execute without error filter_seq() converts all returned sequences to uppercase\nfrom nose.tools import assert_equal\ntest_seqs_case=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ataatggttgttgccagccggtgtggaaggtaacagcaccggtgcgagcctaatgtgccgtctccaccaaca', 'tagtatacgtctAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGAcatTGTCCCTGATTTCTccT']\ncorrect_seqs=['CCGATTAGGACCATCTAATGCACTTGTTACAAGACTTCTTTTAAATACTTTCTTCCTGCCCAGTAGCGGATG', 'ATAATGGTTGTTGCCAGCCGGTGTGGAAGGTAACAGCACCGGTGCGAGCCTAATGTGCCGTCTCCACCAACA', 'TAGTATACGTCTAGGCGTCACCCGCCATCTCTGTGCAGGTGGGCCGACGAGACATTGTCCCTGATTTCTCCT']\nassert_equal(filter_seq(test_seqs_case), correct_seqs)\nprint('Test 3 of 4 passed: filter_seq accepted UPPERCASE and lowercase input and output in UPPERCASE')","metadata":{"nbgrader":{"grade":true,"grade_id":"task2_autograder3_case","locked":true,"points":2,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 3 of 4 passed: filter_seq accepted UPPERCASE and lowercase input and output in UPPERCASE\n"}},"pos":31,"type":"cell"}
{"cell_type":"code","exec_count":13,"id":"3abe75","input":"# Check for a docstring in filter_seq()\n# This cell will execute without error filter_seq() has a docstring\nfrom nose.tools import assert_equal, assert_true\nassert_true(filter_seq.__doc__ is not None)\nprint('Test 4 of 4 passed: filter_seq has a docstring')","metadata":{"nbgrader":{"grade":true,"grade_id":"task2_autograder4_docstring","locked":true,"points":1,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 4 of 4 passed: filter_seq has a docstring\n"}},"pos":32,"type":"cell"}
{"cell_type":"code","exec_count":14,"id":"bfad51","input":"# Check that call_variant() returns the correct output for several different inputs.\nfrom nose.tools import assert_equal\nassert_equal(call_variant('ATGCGACATTGGGATCTGTCTGTTGTCATTCGCGGAAAACATCCGTTCACGAGGCGGACACTGATTGACACGGTTTAA', 6 ), 'L')\nassert_equal(call_variant('ATGTTGCAAAGGTTAGGGAATAGGTTATAA', 4), 'R')\nprint('Test 1 of 2 passed: call_variant() produced correct output for sequences within range')","metadata":{"nbgrader":{"grade":true,"grade_id":"task3_autograder1_function","locked":true,"points":5,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 1 of 2 passed: call_variant() produced correct output for sequences within range\n"}},"pos":34,"type":"cell"}
{"cell_type":"code","exec_count":15,"id":"994e03","input":"# Check that call_variant() returns 'Error' if the position searched is outwith the translated protein sequence.\nfrom nose.tools import assert_equal\nassert_equal(call_variant('ATGCGACATTGGGATCTGTCTGTTGTCATTCGCGGAAAACATCCGTTCACGAGGCGGACACTGATTGACACGGTTTAA', 62 ), 'Error')\nassert_equal(call_variant('ATGTTGCAAAGGTTAGGGAATAGGTTATAA', 41), 'Error')\nassert_equal(call_variant('ATGTTGCAAAGGGTAACGGAGTTAGGGAATAGGTTATAA', 0), 'Error')\nprint('Test 2 of 2 passed: call_variant() returned \"Error\" when position was either 0 or beyond the end of the protein sequence string.')","metadata":{"nbgrader":{"grade":true,"grade_id":"task3_autograder2_error","locked":true,"points":5,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test 2 of 2 passed: call_variant() returned \"Error\" when position was either 0 or beyond the end of the protein sequence string.\n"}},"pos":35,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"28de09","input":"### BEGIN SOLUTION\n%matplotlib inline\nimport matplotlib.pyplot as plt\n\n# Create a frequency table of sequence counts each month.\nfreq_table = spike_df['month_name'].value_counts(sort=False)\n\n# Create a bar plot of the frequency table.\n\nfreq_table.plot.bar(facecolor='w', edgecolor='k');\nplt.xlabel('Month');\nplt.ylabel('Number of sequences');\nplt.title('Number of sequences for each month in the year 2020');\n### END SOLUTION","metadata":{"nbgrader":{"grade":true,"grade_id":"task5_manualgrader","locked":false,"points":5,"schema_version":3,"solution":true,"task":false}},"output":{"0":{"data":{"image/png":"e335677a572a93fd4db3812d202a2038f2718d9b","text/plain":"<Figure size 432x288 with 1 Axes>"},"metadata":{"image/png":{"height":323,"width":401},"needs_background":"light"},"output_type":"execute_result"}},"pos":16,"type":"cell"}
{"cell_type":"code","exec_count":2,"id":"a23621","input":"def filter_seq(dna_seqs):\n    ### BEGIN SOLUTION\n    ''' Input: list of DNA sequences (strings)\n        Output: list of DNA sequences that pass filter\n    '''\n    output =[]\n    for seq in dna_seqs:\n        seq_upper=seq.upper()\n        if len(seq_upper)==72 and not 'N' in seq_upper:\n            output.append(seq_upper)\n    return output\n    ### END SOLUTION","metadata":{"nbgrader":{"grade":false,"grade_id":"task2","locked":false,"schema_version":3,"solution":true,"task":false}},"pos":6,"type":"cell"}
{"cell_type":"code","exec_count":3,"id":"707b00","input":"def call_variant(dna_seq, position):\n    ### BEGIN SOLUTION\n    table = { \n        'ATA':'I', 'ATC':'I', 'ATT':'I', 'ATG':'M',\n        'ACA':'T', 'ACC':'T', 'ACG':'T', 'ACT':'T',\n        'AAC':'N', 'AAT':'N', 'AAA':'K', 'AAG':'K',\n        'AGC':'S', 'AGT':'S', 'AGA':'R', 'AGG':'R',\n        'CTA':'L', 'CTC':'L', 'CTG':'L', 'CTT':'L',\n        'CCA':'P', 'CCC':'P', 'CCG':'P', 'CCT':'P',\n        'CAC':'H', 'CAT':'H', 'CAA':'Q', 'CAG':'Q',\n        'CGA':'R', 'CGC':'R', 'CGG':'R', 'CGT':'R',\n        'GTA':'V', 'GTC':'V', 'GTG':'V', 'GTT':'V',\n        'GCA':'A', 'GCC':'A', 'GCG':'A', 'GCT':'A',\n        'GAC':'D', 'GAT':'D', 'GAA':'E', 'GAG':'E',\n        'GGA':'G', 'GGC':'G', 'GGG':'G', 'GGT':'G',\n        'TCA':'S', 'TCC':'S', 'TCG':'S', 'TCT':'S',\n        'TTC':'F', 'TTT':'F', 'TTA':'L', 'TTG':'L',\n        'TAC':'Y', 'TAT':'Y', 'TAA':'_', 'TAG':'_',\n        'TGC':'C', 'TGT':'C', 'TGA':'_', 'TGG':'W',\n    } \n    protein=\"\" \n    if len(dna_seq)%3 == 0: \n        for i in range(0, len(dna_seq), 3): \n            codon = dna_seq[i:i + 3] \n            protein+= table[codon] \n    if 0 < position <= len(protein):\n        return protein[position-1]\n    else: \n        return 'Error'\n    ### END SOLUTION","metadata":{"nbgrader":{"grade":false,"grade_id":"task3","locked":false,"schema_version":3,"solution":true,"task":false}},"pos":8,"type":"cell"}
{"cell_type":"code","exec_count":6,"id":"d5e499","input":"### BEGIN SOLUTION\nalvin  = spike_df['position_222'].value_counts()\nprint(alvin)\nnick  = spike_df['position_439'].value_counts()\nprint(nick)\ndoug  = spike_df['position_614'].value_counts()\nprint(doug)\n### END SOLUTION","metadata":{"nbgrader":{"grade":true,"grade_id":"task6_manualgrader","locked":false,"points":3,"schema_version":3,"solution":true,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"A    48068\nV    19171\nS        2\nP        1\nF        1\nName: position_222, dtype: int64\nN    66812\nK      431\nName: position_439, dtype: int64\nG    62980\nD     4258\nN        5\nName: position_614, dtype: int64\n"}},"pos":18,"type":"cell"}
{"cell_type":"code","exec_count":7,"id":"4291cb","input":"### BEGIN SOLUTION\n#Cross tab of frequency of D614G\ntable = pd.crosstab(spike_df['month_name'], spike_df['position_614'])\ntable\n### END SOLUTION","metadata":{"nbgrader":{"grade":true,"grade_id":"task7_manualgrader","locked":false,"points":5,"schema_version":3,"solution":true,"task":false}},"output":{"0":{"data":{"text/html":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>position_614</th>\n      <th>D</th>\n      <th>G</th>\n      <th>N</th>\n    </tr>\n    <tr>\n      <th>month_name</th>\n      <th></th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>January</th>\n      <td>1</td>\n      <td>0</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>February</th>\n      <td>35</td>\n      <td>23</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>March</th>\n      <td>2374</td>\n      <td>3694</td>\n      <td>1</td>\n    </tr>\n    <tr>\n      <th>April</th>\n      <td>1623</td>\n      <td>10245</td>\n      <td>4</td>\n    </tr>\n    <tr>\n      <th>May</th>\n      <td>139</td>\n      <td>3540</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>June</th>\n      <td>64</td>\n      <td>5479</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>July</th>\n      <td>7</td>\n      <td>2247</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>August</th>\n      <td>9</td>\n      <td>5834</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>September</th>\n      <td>3</td>\n      <td>12346</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>October</th>\n      <td>3</td>\n      <td>19497</td>\n      <td>0</td>\n    </tr>\n    <tr>\n      <th>November</th>\n      <td>0</td>\n      <td>75</td>\n      <td>0</td>\n    </tr>\n  </tbody>\n</table>\n</div>","text/plain":"position_614     D      G  N\nmonth_name                  \nJanuary          1      0  0\nFebruary        35     23  0\nMarch         2374   3694  1\nApril         1623  10245  4\nMay            139   3540  0\nJune            64   5479  0\nJuly             7   2247  0\nAugust           9   5834  0\nSeptember        3  12346  0\nOctober          3  19497  0\nNovember         0     75  0"},"exec_count":7,"output_type":"execute_result"}},"pos":20,"type":"cell"}
{"cell_type":"code","exec_count":8,"id":"a95f47","input":"### BEGIN SOLUTION\n#Cross tab of frequency of D614G\ntable = pd.crosstab(spike_df['month_name'], spike_df['position_614'], normalize='index')\ntable.plot.bar()\nplt.xlabel('Month')\nplt.ylabel('Relative frequency of amino acid')\nplt.title('Change in relative frequency of amino acid at position 614')\nplt.legend(title='Amino acid');\n### END SOLUTION","metadata":{"nbgrader":{"grade":true,"grade_id":"task8_manualgrader","locked":false,"points":5,"schema_version":3,"solution":true,"task":false}},"output":{"0":{"data":{"image/png":"700b2786d5c9da28b96ce6e105df432382dbf138","text/plain":"<Figure size 432x288 with 1 Axes>"},"metadata":{"image/png":{"height":323,"width":394},"needs_background":"light"},"output_type":"execute_result"}},"pos":22,"type":"cell"}
{"cell_type":"code","exec_count":9,"id":"fc2436","input":"# Check that the function start_present() returns the correct output for several different inputs.\n# This cell will run without error if start_present() works as specified.\nfrom nose.tools import assert_equal\nassert_equal(start_present('ATGGTAGCAGGCTATTAA'), True)\nassert_equal(start_present('TGTAGGCATTAAATGTATGA'), False)\nassert_equal(start_present('GGCTGTAGGCATGTATGA'), False) #internal ATG - should not be detected\nassert_equal(start_present('ATGTGTAGGCATTAGATGTATG'), True) #mutliplt ATG codons (including at start)\n### END HIDDEN TESTS\nprint('Test passed: function start_present() is working correctly.')","metadata":{"nbgrader":{"grade":true,"grade_id":"task1_autograder","locked":true,"points":2,"schema_version":3,"solution":false,"task":false}},"output":{"0":{"name":"stdout","output_type":"stream","text":"Test passed: function start_present() is working correctly.\n"}},"pos":27,"type":"cell"}
{"cell_type":"markdown","id":"127686","input":"## Task 5\n\nUsing the code cell below, plot an appropriate graph to show the number of sequences collected in each calendar month. **(5 marks)**\n","metadata":{"nbgrader":{"grade":false,"grade_id":"task5question","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":15,"type":"cell"}
{"cell_type":"markdown","id":"1b94d4","input":"# Analysing SARS-Cov-2 sequence data: searching for Doug, Nick and Alvin \n\nSince viral genomes mutate over time, molecular epidemiologists are able to track the spread of viral variants by sequencing the viral genomes as cases arise. In this study, we will analyse 67,243 sequences from the SARS-CoV-2 genomes sequenced by [COVID-19 Genomics UK (COG-UK)](https://www.cogconsortium.uk) to detect mutations. We will concentrate our search on the Spike protein, the surface glycoprotein that studs the virus surface and is responsible for cell entry by binding to angiotensin-converting enzyme 2 (ACE2) on the host cell. \n\nIn this project you will study three amino acid mutations in the Spike protein that have been identified in public SARS-CoV-2 sequence databases. \n<div style=\"text-align: center\">\n<img src=\"spike_tr.png\" width=\"90%\" align=\"middle\" />\n</div>\n\n## Who are Doug, Nick and Alvin?\n\n Two viral phylogenomics researchers working in Professor Andrew Rambaut's group at the University of Edinburgh, Aine O'Toole and Verity Hill, named the D614G mutant Doug, with wild-type viral strains lacking the mutation (D614) called Dougless. As more mutations were discovered, Nick (N439K) / Nickless and Alvin (A222V) followed, continuing this nerdy but hilarious unofficial naming convention.\n \n<div style=\"text-align: center\">\n <img src=\"cartoon.png\" width=\"50%\" align=\"middle\"/>\n</div>\n","metadata":{"nbgrader":{"grade":false,"grade_id":"DAP_intro","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":1,"type":"cell"}
{"cell_type":"markdown","id":"200208","input":"# Part 1\n\nSequences in the [COVID-19 Genomics UK (COG-UK)](https://www.cogconsortium.uk) database can be freely downloaded but must be processed to extract the Spike protein sequences and to filter out any sequences that contain poor sequence quality that might affect the analysis. Here, you will write functions that could be used to perform parts of the extraction and validation of the DNA sequences.\n\nYou may be wondering why we're talking about analysing DNA sequences when the SARS-CoV2 virus, as a member of the Coronaviridae, has a positive-stranded RNA genome. This is because the genomes are published as DNA sequences since the RNA sequence is converted to DNA during a process of PCR amplification prior to genome sequencing, therefore they use Thymidine (T) rather then Uracil (U). ","metadata":{"nbgrader":{"grade":false,"grade_id":"part1_intro","locked":true,"remove":false,"schema_version":3,"solution":false,"task":false}},"pos":2,"type":"cell"}
{"cell_type":"markdown","id":"25e858","input":"## Task 1: Processing DNA sequences\n\nOne of the tasks that bioinformaticians need to do is to detect protein-coding genes by looking for start and stop codons in the sequenced viral genomes. Write a Python function named `'start_present'` in the following code cell that takes a single DNA sequence (string) as an argument and returns the Boolean value `True` if the sequence **starts with** 'ATG' and `False` if it does not. **(2 marks)**\n","metadata":{"nbgrader":{"grade":false,"grade_id":"task1_intro","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":3,"type":"cell"}
{"cell_type":"markdown","id":"400880","input":"# Part 2: Exploring SARS-CoV-2 Spike Protein Sequences\n\nFor the second part of this analysis, in early November more than 100,000 sequences were downloaded from the COG-UK database and filtered using functions similar to those you have implemented above to extract full length Spike nucleotide sequence without ambiguous nucleotide calls, and to extract the amino acid calls at positions 222, 439 and 614.\n\nYou have been given a CSV file called [spike_proteins.csv](spike_proteins.csv) of this processed SARS-CoV-2 Spike protein sequence data. The code below will load this CSV file as a Pandas dataframe. It also sets the 'month_name' column as an ordered categorical variable so that plots and tables are ordered chronologically (something we have not covered in the course).\n\n**Run the following code cell to read in the SARS-CoV-2 protein sequence dataset.**\n","metadata":{"nbgrader":{"grade":false,"grade_id":"part2","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":9,"type":"cell"}
{"cell_type":"markdown","id":"47ccdc","input":"## Task 9\n\nBased on the above table and graph, do you think that glycine (G) has replaced aspartate (D) at position 614 in the UK population? Write your answer in the following markdown cell. **(1 mark)**","metadata":{"nbgrader":{"grade":false,"grade_id":"task9question","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":23,"type":"cell"}
{"cell_type":"markdown","id":"561847","input":"## Task 3: Calling protein sequence variants\n\nWe are interested in studying amino acid mutations in our SARS-Cov-2 Spike protein sequences, therefore we need a way to detect which amino acid is at a particular position in the protein. For example, if we're looking for the 'Doug' mutation, we would want to look at position 614 in the protein to determine whether it is an aspartate (D) or glycine (G) amino acid residue. Since we're starting with a DNA sequence, we'll need to first translate our DNA to protein, then look up the amino acid at the specified position.\n\nWrite a Python function named `'call_variant'` in the following code cell that takes two arguments. The first argument is a single DNA sequence which you can assume is in UPPERCASE and contains only the letters A, C, G or T.\n\nWithin your function you should translate the DNA sequence into an amino acid sequence.\n\nThe second argument of the function `'call_variant'` is a position in the amino acid sequence. Your function should return the amino acid letter at this position in the amino acid sequence you have constructed. For example, if your translated DNA sequence is 'VRPL' and the required position is 2, then your function should return amino acid letter 'R'. (Remember that the second position in a string is at index 1.) **(5 marks)**\n\nIf the position passed to the function is zero or is beyond the end of the amino acid sequence your function should **return** the string 'Error'. *Please ensure that your function returns and does not print this string.* **(5 marks)**\n\n","metadata":{"nbgrader":{"grade":false,"grade_id":"task3_intro","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":7,"type":"cell"}
{"cell_type":"markdown","id":"561a13","input":"## Task 2: Filtering valid DNA sequences\n\n\nDNA sequences in public databases may be incomplete or may contain regions of unknown sequence, where the letter 'N' or 'n' is used to indicate that the sequence is ambiguous for that nucleotide position. For example, the DNA sequence 'GGTCACN' contains an ambiguous nucleotide at the last position. \n\nWe may also be interested in filtering out sequences that are too long or short from our analyses: for example, the SARS-CoV-2 Spike Protein sequence data that are provided later in this project were filtered by removing any sequences that were not 3822 nucleotides in length, to remove sequences that may be truncated or erroneous.\n\nWrite a Python function named `'filter_seq'` in the following code cell that takes a **list of DNA sequences** as an argument and returns a **list** containing only those sequences that pass the following two criteria:\n\n1. The sequence contains only the nucleotide letters A, C, G or T, or their lowercase equivalents, and no ambiguous nucleotides (N or n). **(3 marks)**\n2. The sequence must be exactly 72 nucleotides long. **(2 marks)**\n\nIn addition: \n* Your function must accept DNA sequences in the argument to be in lowercase, UPPERCASE or a mixture of both. All sequences that meet the criteria must be returned in UPPERCASE. **(2 marks)**\n* Your function must have a valid function docstring (any text is acceptable). **(1 mark)**\n\nYou will gain partial credit if your function runs but implements only some of the above criteria.","metadata":{"nbgrader":{"grade":false,"grade_id":"task2_intro","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":5,"type":"cell"}
{"cell_type":"markdown","id":"562d53","input":"## Task 6\n\nUsing the code cell below, create and print three frequency tables of the amino acid letters in each of the positions 222, 439 and 614. **(3 marks)**","metadata":{"nbgrader":{"grade":false,"grade_id":"task6question","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":17,"type":"cell"}
{"cell_type":"markdown","id":"676b3b","input":"Each row represents one viral isolate from the COG_UK sequence database. The dataframe has the following variables (column headers):\n\n* **sequence_name**: Unique identifier for the viral isolate sequencing record\n* **country**: UK Country of Origin of the sample\n* **sample_date**: Date of sample collection in the format YYYY-MM-DD\n* **epi_week**:  Epidemiological week: the number of weeks since the start of the year\n* **position_614**: Amino acid letter at position 614\n* **position_439**: Amino acid letter at position 439\n* **position_222**: Amino acid letter at position 222\n* **S_mutations**: The total number of amino acid changes (also known as synonymous mutations) compared to the sequence of the first ever sequenced genome, [Wuhan-Hu-1] (https://www.ncbi.nlm.nih.gov/nuccore/1798174254)\n* **month_name**: The name of the month in which the sample was taken\n* **month**: Numeric coded month of sample collection (1=January, 2=February, etc)","metadata":{"nbgrader":{"grade":false,"grade_id":"dataframe_variables","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":11,"type":"cell"}
{"cell_type":"markdown","id":"6ccfae","input":"## Task 7\n\nIs there an association between amino acid letter in position 614 and calendar month? \n\nIn the code cell below, create an appropriate table to show the frequency of the amino acid letters at position 614 in each calendar month. **(5 marks)**","metadata":{"nbgrader":{"grade":false,"grade_id":"task7question","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":19,"type":"cell"}
{"cell_type":"markdown","id":"6d9184","input":"### Task 1 Autograder","metadata":{"nbgrader":{"grade":false,"grade_id":"6d9184","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":26,"type":"cell"}
{"cell_type":"markdown","id":"72b71f","input":"### Task 3 Autograders\n\nThis task has two components for which marks are assigned, therefore there are two autograders that must both pass for full marks. \n","metadata":{"nbgrader":{"grade":false,"grade_id":"72b71f","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":33,"type":"cell"}
{"cell_type":"markdown","id":"7a64d3","input":"# QSB-1 Data Analysis Project: Instructions\n\n### Marking Scheme\n\n**Tasks 1, 2 and 3** ask you to write functions to perform specified tasks. Please complete the functions in the markdown cells provided, removing the `# YOUR CODE HERE` and `raise NotImplementedError()` text from the cell and replacing with your own code. These functions will be automatically marked by a computer, which will test whether your functions perform the required operations and award marks where those tests pass. You will receive partial marks if your code runs but fails to perform some of the requirements, but you will not receive any marks if you code produces an error or fails to return any valid values. It is critical that your functions are named as specified in the questions and that they return the values requested, without any additional output.\n\nPlease see **this video** for a full description of how to use the autograder cells to test your functions.\n\n**Tasks 4 to 9** are manually marked, according to the marks shown beside each question. In this section, you will be scored on correct coding, appropriate choice of tables or graphs and in presenting them in accordance with good principles for the display of data (such as using appropriate axis labels and titles).\n\n### Plagiarism and collusion\n\nThis data analysis project forms a part of your course assessment and **must be your own work**. You are encouraged to use the self study notebooks, workshop notebooks, internet search and online Python documentation, and to use or adapt code examples from each of those sources.  However you must not help or receive help from anyone, and must not use code written by other students.\n\nYou must use Python comments (#) to give the source of any code you have taken or adapted from other sources unless it is from the course notebooks and workshop material.\n\nAll work will be checked for evidence of plagiarism and collusion - please familiarise yourself with the information on plagiarism in the course handbook.\n\n### Deadline and submission information\n\nThis workbook will be automatically submitted at 2pm on Monday 7th December, which is the deadline for this assignment. You do not need to do anything to submit other than ensure your notebook is saved (Click File>Save to the upper left hand side of this page).\n","metadata":{"nbgrader":{"grade":false,"grade_id":"DAP_instructions","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":0,"type":"cell"}
{"cell_type":"markdown","id":"883f0a","input":"### Write your answer to Task 4 in this cell\n\n* sequence_name:\n* country:\n* sample_date:\n* epi_week:\n* position_614:\n* position_439:\n* position_222:\n* S_mutations:\n* month_name:\n* month:","pos":13,"type":"cell"}
{"cell_type":"markdown","id":"9a9032","input":"## Task 4\n\nWhat are the **types** of each of the variables in this dataset? Put your answers in the following markdown cell. **(Formative question: 0 marks)**","metadata":{"nbgrader":{"grade":false,"grade_id":"task4","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":12,"type":"cell"}
{"cell_type":"markdown","id":"def095","input":"### Task 2 Autograders\n\nThis task has four requirements for which marks are assigned, therefore there are four autograders that must all pass for full marks.","metadata":{"nbgrader":{"grade":false,"grade_id":"def095","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":28,"type":"cell"}
{"cell_type":"markdown","id":"eccb37","input":"## Task 8\n\nIn the code cell below, create an appropriate graph of the **relative frequency** of amino acid letters in each month. **(5 marks)**","metadata":{"nbgrader":{"grade":false,"grade_id":"task8question","locked":true,"schema_version":3,"solution":false,"task":false}},"pos":21,"type":"cell"}
{"cell_type":"markdown","id":"ed5517","input":"### Write your answer to Task 9 in this cell\n=== BEGIN MARK SCHEME ===\n\nGlycine had replaced aspartate at position 614 in the UK population by the summer.\n\n=== END MARK SCHEME ===","metadata":{"nbgrader":{"grade":true,"grade_id":"task9_manualgrader","locked":false,"points":1,"schema_version":3,"solution":true,"task":false}},"pos":24,"type":"cell"}
{"cell_type":"markdown","id":"ef6d96","input":"# Autograder Test Cells\n\nYou can use the autograder tests below to test that your functions are working correctly. If your function is correct, running the cell will print a message stating that the test has passed. If there is an error in your function, the code cell will produce an Assertion Error. You may also add additional code cells in this notebook to help you to debug your code, but please remove these prior to the project submission date.\n\nPlease note that you must run the cell containing your functions before running these cells. If you have made changes to a function, you must re-run that cell before running a test again to get an accurate result. ","pos":25,"type":"cell"}
{"cell_type":"markdown","id":"f0f00a","input":"### Task 4 answers (0 marks)\n=== BEGIN MARK SCHEME ===\nvariable | type\n:---|:---\nsequence_name | categorical nominal\ncountry | categorical nominal\nsample_date | categorical ordinal\nepi_week | categorical ordinal or numerical discrete\nposition_614 | categorical nominal\nposition_439 | categorical nominal\nposition_222 | categorical nominal\nS_mutations | numerical discrete\nmonth_name | categorical ordinal\nmonth | categorical ordinal or numerical discrete\n=== END MARK SCHEME ===","metadata":{"nbgrader":{"grade":false,"grade_id":"task4_answers","locked":false,"remove":true,"schema_version":3,"solution":false,"task":false}},"pos":14,"type":"cell"}
{"id":0,"time":1635856084604,"type":"user"}
{"last_load":1635856084358,"type":"file"}